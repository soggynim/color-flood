<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="theme-color" content="#0b0f1e" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <title>Color Flood</title>
  <link rel="manifest" href="./manifest.json" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="./style.css" />
</head>
<body>

  <!-- Always-on background layers -->
  <div class="bg-grid"></div>
  <div class="orb orb-1"></div>
  <div class="orb orb-2"></div>
  <div class="orb orb-3"></div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREEN 1: Splash
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="screen-splash" class="screen active">
    <div class="splash-inner">

      <div class="logo-lockup">
        <div class="logo-mark">ğŸŒŠ</div>
        <h1 class="game-title">Color <span>Flood</span></h1>
      </div>

      <p class="tagline">Fill the board. Beat the grid.</p>

      <div class="profile-section">
        <div class="section-label">Select Player</div>
        <div id="profile-list" class="profile-list"></div>
        <button id="btn-new-profile" class="btn btn-primary btn-full">
          + New Player
        </button>
      </div>

    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREEN 2: New Profile
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="screen-new-profile" class="screen">
    <div class="screen-center">
      <div class="profile-form-card">

        <div class="form-header">
          <h2>Create Player</h2>
          <p>Choose your name and avatar</p>
        </div>

        <div>
          <div class="input-label">Your Name</div>
          <input id="profile-name-input" type="text" maxlength="16"
                 placeholder="Enter name..." class="name-input" autocomplete="off" />
        </div>

        <div class="avatar-section">
          <div class="input-label">Pick an Avatar</div>
          <div class="avatar-grid" id="avatar-picker">
            <span class="avatar-opt" data-avatar="ğŸ¦">ğŸ¦</span>
            <span class="avatar-opt" data-avatar="ğŸ¯">ğŸ¯</span>
            <span class="avatar-opt" data-avatar="ğŸ¸">ğŸ¸</span>
            <span class="avatar-opt" data-avatar="ğŸ¼">ğŸ¼</span>
            <span class="avatar-opt" data-avatar="ğŸ¦Š">ğŸ¦Š</span>
            <span class="avatar-opt" data-avatar="ğŸ§">ğŸ§</span>
            <span class="avatar-opt" data-avatar="ğŸ¦„">ğŸ¦„</span>
            <span class="avatar-opt" data-avatar="ğŸ‰">ğŸ‰</span>
          </div>
        </div>

        <div class="btn-row">
          <button id="btn-cancel-profile" class="btn btn-surface" style="flex:1">Cancel</button>
          <button id="btn-save-profile" class="btn btn-primary" style="flex:2">Create Player</button>
        </div>

      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREEN 3: Level Select
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="screen-levels" class="screen">
    <header class="game-header">
      <button id="btn-back-to-splash" class="btn-icon">â†</button>
      <div class="level-info-center">
        <div id="active-profile-display" class="profile-badge"></div>
      </div>
      <div class="spacer"></div>
    </header>
    <div class="levels-scroll">

      <div class="tier-block">
        <div class="tier-header">
          <span class="tier-icon">ğŸŒ±</span>
          <span class="tier-title">Beginner</span>
          <div class="tier-line"></div>
        </div>
        <div id="level-grid-1" class="level-grid"></div>
      </div>

      <div class="tier-block">
        <div class="tier-header">
          <span class="tier-icon">ğŸ”¥</span>
          <span class="tier-title">Getting Harder</span>
          <div class="tier-line"></div>
        </div>
        <div id="level-grid-2" class="level-grid"></div>
      </div>

      <div class="tier-block">
        <div class="tier-header">
          <span class="tier-icon">âš¡</span>
          <span class="tier-title">Challenge</span>
          <div class="tier-line"></div>
        </div>
        <div id="level-grid-3" class="level-grid"></div>
      </div>

      <div class="tier-block">
        <div class="tier-header">
          <span class="tier-icon">ğŸ†</span>
          <span class="tier-title">Expert</span>
          <div class="tier-line"></div>
        </div>
        <div id="level-grid-4" class="level-grid"></div>
      </div>

      <div class="tier-block">
        <div class="tier-header">
          <span class="tier-icon">ğŸ’</span>
          <span class="tier-title">Master</span>
          <div class="tier-line"></div>
        </div>
        <div id="level-grid-5" class="level-grid"></div>
      </div>

      <div class="tier-block">
        <div class="tier-header">
          <span class="tier-icon">ğŸ‘‘</span>
          <span class="tier-title">Legend</span>
          <div class="tier-line"></div>
        </div>
        <div id="level-grid-6" class="level-grid"></div>
      </div>

    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SCREEN 4: Game
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="screen-game" class="screen">
    <header class="game-header">
      <button id="btn-back-to-levels" class="btn-icon">â†</button>
      <div class="level-info-center">
        <span id="level-label">Level 1</span>
        <span id="moves-label" class="moves-display">0 / 10 moves</span>
        <div class="moves-bar-wrap">
          <div id="moves-bar" class="moves-bar-fill" style="width:100%"></div>
        </div>
      </div>
      <button id="btn-restart" class="btn-icon" title="Restart">â†º</button>
    </header>
    <div class="game-area">
      <canvas id="game-canvas"></canvas>
    </div>
    <div id="color-buttons" class="color-buttons"></div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       OVERLAY: Win
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="overlay-win" class="overlay hidden">
    <div class="overlay-card">
      <div class="overlay-top-bar win-bar"></div>
      <div class="overlay-emoji">ğŸ‰</div>
      <h2>Level Complete!</h2>
      <p id="win-detail">Great job!</p>
      <div class="overlay-divider"></div>
      <button id="btn-next-level" class="btn btn-primary btn-full">Next Level â†’</button>
      <button id="btn-win-levels" class="btn btn-surface btn-full">All Levels</button>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       OVERLAY: Fail
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="overlay-fail" class="overlay hidden">
    <div class="overlay-card">
      <div class="overlay-top-bar fail-bar"></div>
      <div class="overlay-emoji">ğŸ˜…</div>
      <h2>Out of Moves</h2>
      <p>Keep trying â€” you've got this!</p>
      <div class="overlay-divider"></div>
      <button id="btn-retry" class="btn btn-primary btn-full">Try Again</button>
      <button id="btn-fail-levels" class="btn btn-surface btn-full">All Levels</button>
    </div>
  </div>

  <script src="./config.js" onerror="void(0)"></script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.getRegistrations().then(regs => {
        regs.forEach(reg => reg.unregister());
      }).then(() => {
        navigator.serviceWorker.register('./service-worker.js');
      });
    }
  </script>
  <script src="./levels.js"></script>
  <script src="./supabase-client.js"></script>
  <script src="./profiles.js"></script>
  <script src="./game.js"></script>
  <script src="./app.js"></script>
</body>
</html>
